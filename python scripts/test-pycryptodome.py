from Crypto.Random import get_random_bytes
from ethereum.utils import (
    int_to_bytes, sha3
)


def count_bitlen(x):
    x_str = str(hex(x)).replace('0x', '')
    charlen = len(x_str)
    bitlen = charlen * 4
    if x_str[0] in ['1']:
        bitlen -= 3
    elif x_str[0] in ['2', '3']:
        bitlen -= 2
    elif x_str[0] in ['4', '5', '6', '7']:
        bitlen -= 1
    return bitlen


if __name__ == '__main__':

    key = []
    rand = []


    p = 153098272504387072266936256155440771844922582242861823323292219309209807318109992190455717597749270325963123403359939192028947724926144342818770586136136126337375436706876614423863264051678326206739626203872223116203206738831155125839612432933059096643057013804321361170650382385182136069811475540151279147259
    g = 48095861804730928538428071688224004229592704416264787635743716356958582448226167154685924895443220005707859651277553435409220536317215422963672871914841517783042349761227906722244783116777179995820326154186287286353935949308174273056377987690394866714089833749644657555907806410435558837920979345110898160449
    k = 10022446701738583271276071804010446073913280425189472942303437612418862851223244723245226017322005926246813100742541609377103046893136104044015161562561526985453585647020566093167977121428923628169372925889701872928538625011078052920813557913682354018653924330859466163743103828247525446549945542160664745508

    c_val = sha3(int_to_bytes(g) + int_to_bytes(p) + int_to_bytes(k))

    c = int.from_bytes(c_val, byteorder='big')

    print("c:", count_bitlen(c), ":", c)


    for j in range(0,1):
        key_bytes = get_random_bytes(128)
        rand_bytes = get_random_bytes(32)
        #print("r ",j, ":", rand_bytes)
        key.append(int.from_bytes(key_bytes, byteorder='big'))
        rand.append(int.from_bytes(rand_bytes, byteorder='big'))
        print("k ",j, ":", key[j])
        print("r ",j, ":", rand[j])

