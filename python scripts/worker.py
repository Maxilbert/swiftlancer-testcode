## password = blockchain.njit.edu
from Crypto.Random import get_random_bytes
import random
from utils import connect_web3 as connect
from web3 import Web3
from ethereum.utils import (
    int_to_bytes, sha3
)

#Total Gas Used for  11  Workers:  19834868   : 0x4F6AEEeb1d02026029A9F12C5B5A2e042D3fd31c - 2 junks
#Total Gas Used for  3  Workers:  3668501    : 0x3A9b793C1e93b1f4ad8bFE64F3AcBa4ccD810603
#Total Gas Used for  5  Workers:  8146731    : 0x0D2f4F2EE34CAaeaA5bddBFfcb5679c4D9ECFd20
#Total Gas Used for  7  Workers:  12623250   : 0xFd7a11083D53EAd42846690F07b2c53F8813ABeE
#Total Gas Used for  9  Workers:  17105379   : 0xFF9B22C9114BdF668B51D9D29dbF990AF0ea25d4
#Total Gas Used for  11  Workers:  21579579  : 0x08D9c4E8CCDFdb3D173ffb04960499bdAeafF71f

def egcd(a, b):
    if a == 0:
        return (b, 0, 1)
    g, y, x = egcd(b%a,a)
    return (g, x - (b//a) * y, y)

def modinv(a, m):
    g, x, y = egcd(a, m)
    if g != 1:
        #raise Exception('No modular inverse')
        return 0
    return x%m


def enc(m, r):
    c_1 = pow(g, r, p)
    c_2 = pow(h, r, p) * pow(g, m, p) % p
    return c_1, c_2

def count_bitlen(x):
    x_str = str(hex(x)).replace('0x', '')
    charlen = len(x_str)
    bitlen = charlen * 4
    if x_str[0] in ['1']:
        bitlen -= 3
    elif x_str[0] in ['2', '3']:
        bitlen -= 2
    elif x_str[0] in ['4', '5', '6', '7']:
        bitlen -= 1
    return bitlen

if __name__ == '__main__':

    key = []
    rand = []
    num_workers = 11

    #answers = [0, 1, 0, 3, 0, 1, 1, 0, 0, 4, 1]

    #answers = [0, 1, 0]
    #answers = [0, 1, 0, 1, 0]
    #answers = [0, 1, 0, 1, 0, 1, 0]
    #answers = [0, 1, 0, 1, 0, 1, 0, 1, 0]
    answers = [0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0]
    # tx_hash
    # init_id = 0x6d0f28a4c48c0c0be056b3b3701bb603c4c01eec      # address of init_par contract
    # init_ par = 0x6d0f28A4C48C0C0Be056B3b3701Bb603c4c01EEc
    # task_id = 0x0x42511b59380da91c1e6c5e71f5b51ac87ce972bf      # address of swiftlancer contract
    # task_add = 0x42511b59380DA91c1e6c5e71F5B51AC87cE972bF

    p = 153098272504387072266936256155440771844922582242861823323292219309209807318109992190455717597749270325963123403359939192028947724926144342818770586136136126337375436706876614423863264051678326206739626203872223116203206738831155125839612432933059096643057013804321361170650382385182136069811475540151279147259
    g = 48095861804730928538428071688224004229592704416264787635743716356958582448226167154685924895443220005707859651277553435409220536317215422963672871914841517783042349761227906722244783116777179995820326154186287286353935949308174273056377987690394866714089833749644657555907806410435558837920979345110898160449
    k = 10022446701738583271276071804010446073913280425189472942303437612418862851223244723245226017322005926246813100742541609377103046893136104044015161562561526985453585647020566093167977121428923628169372925889701872928538625011078052920813557913682354018653924330859466163743103828247525446549945542160664745508

    h = pow(g, k, p)

    for j in range(0, num_workers):
        #key_bytes = get_random_bytes(128)
        rand_bytes = get_random_bytes(32)
        '''if(j == (num_workers/2)):
            ans = 2
        else:
            ans = random.randint(0,2)
        answers.append(ans)'''
        #key.append(int.from_bytes(key_bytes, byteorder='big'))
        rand.append(int.from_bytes(rand_bytes, byteorder='big'))
        #print("key ",j, ":", key[j])
        print("randomness ",j, ":", rand[j])
        print("answer", j, ":", answers[j])

    abi = '[{"constant":false,"inputs":[{"name":"index","type":"uint256"},{"name":"a_val","type":"bytes"},{"name":"z_val","type":"bytes"},{"name":"z_bitlen","type":"uint256"},{"name":"m_val","type":"bytes"},{"name":"m_bitlen","type":"uint256"},{"name":"hash_length","type":"uint256"}],"name":"compute_range_proof_lhs","outputs":[{"name":"","type":"bytes"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"index1","type":"uint256"},{"name":"index2","type":"uint256"},{"name":"a_val","type":"bytes"},{"name":"z_val","type":"bytes"},{"name":"z_bitlen","type":"uint256"},{"name":"hash_length","type":"uint256"}],"name":"zero_and_one_rhs","outputs":[{"name":"","type":"bytes"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"i","type":"uint256"}],"name":"collect_answers","outputs":[{"name":"","type":"bytes"},{"name":"","type":"bool"},{"name":"","type":"uint256"},{"name":"","type":"bytes"},{"name":"","type":"bool"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_data","type":"bytes32"}],"name":"toBytes","outputs":[{"name":"","type":"bytes"}],"payable":false,"stateMutability":"pure","type":"function"},{"constant":false,"inputs":[{"name":"index","type":"uint256"},{"name":"a_val","type":"bytes"},{"name":"a_bitlen","type":"uint256"},{"name":"z_val","type":"bytes"},{"name":"z_bitlen","type":"uint256"},{"name":"hash_length","type":"uint256"}],"name":"compute_range_proof_rhs","outputs":[{"name":"","type":"bytes"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"num_workers","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"c1_val","type":"bytes"},{"name":"c1_bitlen","type":"uint256"},{"name":"c2_val","type":"bytes"},{"name":"c2_bitlen","type":"uint256"}],"name":"submit_answers","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"index","type":"uint256"},{"name":"a_val","type":"bytes"},{"name":"a_bitlen","type":"uint256"},{"name":"z_val","type":"bytes"},{"name":"z_bitlen","type":"uint256"},{"name":"m_val","type":"bytes"},{"name":"m_bitlen","type":"uint256"},{"name":"hash_length","type":"uint256"}],"name":"verify_out_of_range_proof","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"index1","type":"uint256"},{"name":"index2","type":"uint256"},{"name":"a_val","type":"bytes"},{"name":"a_bitlen","type":"uint256"},{"name":"z_val","type":"bytes"},{"name":"z_bitlen","type":"uint256"},{"name":"hash_length","type":"uint256"}],"name":"verify_same_plaintext_proof","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"index1","type":"uint256"},{"name":"index2","type":"uint256"},{"name":"a_val","type":"bytes"},{"name":"a_bitlen","type":"uint256"},{"name":"z_val","type":"bytes"},{"name":"z_bitlen","type":"uint256"},{"name":"hash_length","type":"uint256"}],"name":"compute_plaintext_proof_rhs","outputs":[{"name":"","type":"bytes"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"index1","type":"uint256"},{"name":"index2","type":"uint256"},{"name":"a_val","type":"bytes"},{"name":"z_val","type":"bytes"},{"name":"z_bitlen","type":"uint256"},{"name":"hash_length","type":"uint256"}],"name":"zero_and_one_lhs","outputs":[{"name":"","type":"bytes"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"get_current_worker","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"answers_map","outputs":[{"components":[{"name":"val","type":"bytes"},{"name":"neg","type":"bool"},{"name":"bitlen","type":"uint256"}],"name":"c1","type":"tuple"},{"components":[{"name":"val","type":"bytes"},{"name":"neg","type":"bool"},{"name":"bitlen","type":"uint256"}],"name":"c2","type":"tuple"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"current_worker_num","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"index1","type":"uint256"},{"name":"index2","type":"uint256"},{"name":"a_val","type":"bytes"},{"name":"a_bitlen","type":"uint256"},{"name":"z_val","type":"bytes"},{"name":"z_bitlen","type":"uint256"},{"name":"hash_length","type":"uint256"}],"name":"verify_zero_and_one_proof","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"index1","type":"uint256"},{"name":"index2","type":"uint256"},{"name":"a_val","type":"bytes"},{"name":"a_bitlen","type":"uint256"},{"name":"z_val","type":"bytes"},{"name":"z_bitlen","type":"uint256"},{"name":"hash_length","type":"uint256"}],"name":"compute_plaintext_proof_lhs","outputs":[{"name":"","type":"bytes"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"a","type":"string"}],"name":"Test","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"a","type":"string"}],"name":"Collection","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"b","type":"string"}],"name":"Answers_Test","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"a","type":"string"}],"name":"Same_PlainText","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"b","type":"string"}],"name":"Out_Of_Range","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"a","type":"string"}],"name":"Zero_And_One","type":"event"}]'


    bin = '0x608060405260a060405190810160405280608081526020017f447da3cd62f803c191a7f65e91e582a2c56002c59c6205676b561b7e43dee69d81526020017f889e8a7e4e22cb6ca321f7f0ff29005d1b7aca5f0afa26f88e6bce1d2b4503c881526020017f9ff55640b109eb0ceb6b304c8d1f0b3015d5f656a49df24aae9daeabf06085bf81526020017f3b554dc5628fc3a4b0b1d3849ae8530a415219818afadccc05e40c0c9e19b34181525060039080519060200190620000c4929190620007ff565b506000600460006101000a81548160ff0219169083151502179055506103ff60055560a060405190810160405280608081526020017fbd49fe4da96732c03a350fa45cd8ea71fd30d768f08c9bfc896fb03daaf8d3fb81526020017fcf6c9c08fdd65e089ae96db1b0051e9b620a9debffabf1c7f4ce663c1e9740cd81526020017fb1654a9f09a83051a75cadf9869d34a25c7ccfac84f9cda891f0130eb7b98cdf81526020017fba3c1e7d2efcc5c3b328d770989329537c8d56b4a16921ef56594f7406caf94d81525060069080519060200190620001a6929190620007ff565b506000600760006101000a81548160ff02191690831515021790555061040060085560a060405190810160405280608081526020017fda04e8c7457591a5f303377378fdf9777bc7f9bb2957458b40107605692fd8a981526020017f38e34c8cc0f63486d375ffc9f17ff170c06b1d9d4d6c40d16bc34b5f145f365981526020017f8c987c624d60c25335b258460f1dcaaa15df44e1c8dff6b556fa5283198956f481526020017f864dbca5ff6a2cb02f551a6e17c45e9efc0b540f21c36d56d6763a188459d8fb8152506009908051906020019062000288929190620007ff565b506000600a60006101000a81548160ff021916908315150217905550610400600b5560a060405190810160405280608081526020016000815260200160008152602001600081526020016001815250600c9080519060200190620002ee929190620007ff565b506000600d60006101000a81548160ff0219169083151502179055506001600e5560606040519081016040528060038054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015620003b55780601f106200038957610100808354040283529160200191620003b5565b820191906000526020600020905b8154815290600101906020018083116200039757829003601f168201915b50505050508152602001600460009054906101000a900460ff1615158152602001600554815250600f6000820151816000019080519060200190620003fc92919062000886565b5060208201518160010160006101000a81548160ff02191690831515021790555060408201518160020155505060606040519081016040528060068054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015620004cf5780601f10620004a357610100808354040283529160200191620004cf565b820191906000526020600020905b815481529060010190602001808311620004b157829003601f168201915b50505050508152602001600760009054906101000a900460ff1615158152602001600854815250601260008201518160000190805190602001906200051692919062000886565b5060208201518160010160006101000a81548160ff02191690831515021790555060408201518160020155505060606040519081016040528060098054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015620005e95780601f10620005bd57610100808354040283529160200191620005e9565b820191906000526020600020905b815481529060010190602001808311620005cb57829003601f168201915b50505050508152602001600a60009054906101000a900460ff1615158152602001600b54815250601560008201518160000190805190602001906200063092919062000886565b5060208201518160010160006101000a81548160ff021916908315150217905550604082015181600201555050606060405190810160405280600c8054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015620007035780601f10620006d75761010080835404028352916020019162000703565b820191906000526020600020905b815481529060010190602001808311620006e557829003601f168201915b50505050508152602001600d60009054906101000a900460ff1615158152602001600e54815250601860008201518160000190805190602001906200074a92919062000886565b5060208201518160010160006101000a81548160ff0219169083151502179055506040820151816002015550503480156200078457600080fd5b5060016000806101000a81548160ff02191690836002811115620007a457fe5b021790555033600060016101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060018081905550600f60028190555062000935565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200084257805160ff191683800117855562000873565b8280016001018555821562000873579182015b828111156200087257825182559160200191906001019062000855565b5b5090506200088291906200090d565b5090565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10620008c957805160ff1916838001178555620008fa565b82800160010185558215620008fa579182015b82811115620008f9578251825591602001919060010190620008dc565b5b5090506200090991906200090d565b5090565b6200093291905b808211156200092e57600081600090555060010162000914565b5090565b90565b61558380620009456000396000f3006080604052600436106100e6576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806303e2fc40146100eb5780631a168e5e146102885780632d7e38a5146103df578063326cf61c1461051557806335a104ca146105bf5780633c2906aa14610716578063444a2eb41461074157806345677b8014610804578063498161ed146109435780635c7bd6bf14610a3c5780638b42e6d814610b9d5780639799648414610cf457806398689c2d14610d1f578063b8a7068e14610d67578063ce931e2d14610d92578063dcdba76b14610e8b575b600080fd5b3480156100f757600080fd5b5061020660048036038101908080359060200190929190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919291929080359060200190929190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091929192908035906020019092919080359060200190929190505050610fec565b6040518080602001838152602001828103825284818151815260200191508051906020019080838360005b8381101561024c578082015181840152602081019050610231565b50505050905090810190601f1680156102795780820380516001836020036101000a031916815260200191505b50935050505060405180910390f35b34801561029457600080fd5b5061035d6004803603810190808035906020019092919080359060200190929190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091929192908035906020019092919080359060200190929190505050611571565b6040518080602001838152602001828103825284818151815260200191508051906020019080838360005b838110156103a3578082015181840152602081019050610388565b50505050905090810190601f1680156103d05780820380516001836020036101000a031916815260200191505b50935050505060405180910390f35b3480156103eb57600080fd5b5061040a60048036038101908080359060200190929190505050611ad7565b6040518080602001871515151581526020018681526020018060200185151515158152602001848152602001838103835289818151815260200191508051906020019080838360005b8381101561046e578082015181840152602081019050610453565b50505050905090810190601f16801561049b5780820380516001836020036101000a031916815260200191505b50838103825286818151815260200191508051906020019080838360005b838110156104d45780820151818401526020810190506104b9565b50505050905090810190601f1680156105015780820380516001836020036101000a031916815260200191505b509850505050505050505060405180910390f35b34801561052157600080fd5b506105446004803603810190808035600019169060200190929190505050611d4a565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015610584578082015181840152602081019050610569565b50505050905090810190601f1680156105b15780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3480156105cb57600080fd5b5061069460048036038101908080359060200190929190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919291929080359060200190929190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091929192908035906020019092919080359060200190929190505050611d7b565b6040518080602001838152602001828103825284818151815260200191508051906020019080838360005b838110156106da5780820151818401526020810190506106bf565b50505050905090810190601f1680156107075780820380516001836020036101000a031916815260200191505b50935050505060405180910390f35b34801561072257600080fd5b5061072b6121ea565b6040518082815260200191505060405180910390f35b34801561074d57600080fd5b50610802600480360381019080803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919291929080359060200190929190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290803590602001909291905050506121f0565b005b34801561081057600080fd5b5061092960048036038101908080359060200190929190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919291929080359060200190929190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919291929080359060200190929190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919291929080359060200190929190803590602001909291905050506124f7565b604051808215151515815260200191505060405180910390f35b34801561094f57600080fd5b50610a226004803603810190808035906020019092919080359060200190929190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919291929080359060200190929190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091929192908035906020019092919080359060200190929190505050612875565b604051808215151515815260200191505060405180910390f35b348015610a4857600080fd5b50610b1b6004803603810190808035906020019092919080359060200190929190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919291929080359060200190929190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091929192908035906020019092919080359060200190929190505050612b5b565b6040518080602001838152602001828103825284818151815260200191508051906020019080838360005b83811015610b61578082015181840152602081019050610b46565b50505050905090810190601f168015610b8e5780820380516001836020036101000a031916815260200191505b50935050505060405180910390f35b348015610ba957600080fd5b50610c726004803603810190808035906020019092919080359060200190929190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919291929080359060200190929190803590602001909291905050506131aa565b6040518080602001838152602001828103825284818151815260200191508051906020019080838360005b83811015610cb8578082015181840152602081019050610c9d565b50505050905090810190601f168015610ce55780820380516001836020036101000a031916815260200191505b50935050505060405180910390f35b348015610d0057600080fd5b50610d096139b4565b6040518082815260200191505060405180910390f35b348015610d2b57600080fd5b50610d4a600480360381019080803590602001909291905050506139be565b604051808381526020018281526020019250505060405180910390f35b348015610d7357600080fd5b50610d7c613b86565b6040518082815260200191505060405180910390f35b348015610d9e57600080fd5b50610e716004803603810190808035906020019092919080359060200190929190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919291929080359060200190929190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091929192908035906020019092919080359060200190929190505050613b8c565b604051808215151515815260200191505060405180910390f35b348015610e9757600080fd5b50610f6a6004803603810190808035906020019092919080359060200190929190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919291929080359060200190929190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091929192908035906020019092919080359060200190929190505050613e70565b6040518080602001838152602001828103825284818151815260200191508051906020019080838360005b83811015610fb0578082015181840152602081019050610f95565b50505050905090810190601f168015610fdd5780820380516001836020036101000a031916815260200191505b50935050505060405180910390f35b60606000610ff861548e565b61100061548e565b61100861548e565b61101061548e565b61101861548e565b61113b8d600360066040518084805190602001908083835b6020831015156110555780518252602082019150602081019050602083039250611030565b6001836020036101000a038019825116818451168082178552505050505050905001838054600181600116156101000203166002900480156110ce5780601f106110ac5761010080835404028352918201916110ce565b820191906000526020600020905b8154815290600101906020018083116110ba575b5050828054600181600116156101000203166002900480156111275780601f10611105576101008083540402835291820191611127565b820191906000526020600020905b815481529060010190602001808311611113575b505093505050506040518091039020611d4a565b85600001819052506000856020019015159081151581525050878560400181815250508983600001819052506000836020019015159081151581525050888360400181815250508b826000018190525060008260200190151590811515815250508a826040018181525050601b60008f81526020019081526020016000206000016000018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156112535780601f1061122857610100808354040283529160200191611253565b820191906000526020600020905b81548152906001019060200180831161123657829003601f168201915b505050505084600001819052506000846020019015159081151581525050601b60008f81526020019081526020016000206000016002015484604001818152505061154d61138083601560606040519081016040529081600082018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156113425780601f1061131757610100808354040283529160200191611342565b820191906000526020600020905b81548152906001019060200180831161132557829003601f168201915b505050505081526020016001820160009054906101000a900460ff16151515158152602001600282015481525050876144bf9092919063ffffffff16565b601560606040519081016040529081600082018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156114275780601f106113fc57610100808354040283529160200191611427565b820191906000526020600020905b81548152906001019060200180831161140a57829003601f168201915b505050505081526020016001820160009054906101000a900460ff1615151515815260200160028201548152505061153e88601560606040519081016040529081600082018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156115005780601f106114d557610100808354040283529160200191611500565b820191906000526020600020905b8154815290600101906020018083116114e357829003601f168201915b505050505081526020016001820160009054906101000a900460ff16151515158152602001600282015481525050886144bf9092919063ffffffff16565b61458a9092919063ffffffff16565b90508060000151816040015181915096509650505050505097509795505050505050565b6060600061157d61548e565b61158561548e565b61158d61548e565b61159561548e565b61159d61548e565b6116c08b600360066040518084805190602001908083835b6020831015156115da57805182526020820191506020810190506020830392506115b5565b6001836020036101000a038019825116818451168082178552505050505050905001838054600181600116156101000203166002900480156116535780601f10611631576101008083540402835291820191611653565b820191906000526020600020905b81548152906001019060200180831161163f575b5050828054600181600116156101000203166002900480156116ac5780601f1061168a5761010080835404028352918201916116ac565b820191906000526020600020905b815481529060010190602001808311611698575b505093505050506040518091039020611d4a565b8560000181905250600085602001901515908115158152505087856040018181525050898460000181905250600084602001901515908115158152505088846040018181525050601b60008e81526020019081526020016000206003016000018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156117b45780601f10611789576101008083540402835291602001916117b4565b820191906000526020600020905b81548152906001019060200180831161179757829003601f168201915b505050505083600001819052506000836020019015159081151581525050601b60008e815260200190815260200160002060030160020154836040018181525050601b60008d81526020019081526020016000206003016000018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156118a25780601f10611877576101008083540402835291602001916118a2565b820191906000526020600020905b81548152906001019060200180831161188557829003601f168201915b505050505082600001819052506000826020019015159081151581525050601b60008d815260200190815260200160002060030160020154826040018181525050611ab485601560606040519081016040529081600082018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561198e5780601f106119635761010080835404028352916020019161198e565b820191906000526020600020905b81548152906001019060200180831161197157829003601f168201915b505050505081526020016001820160009054906101000a900460ff16151515158152602001600282015481525050611aa585601560606040519081016040529081600082018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611a675780601f10611a3c57610100808354040283529160200191611a67565b820191906000526020600020905b815481529060010190602001808311611a4a57829003601f168201915b505050505081526020016001820160009054906101000a900460ff161515151581526020016002820154815250508861458a9092919063ffffffff16565b6144bf9092919063ffffffff16565b905080600001518160400151819150965096505050505050965096945050505050565b606060008060606000807f5c5acbb8a0d2bcff726d76a63bce13f1ec9ce11f7806241e602b4ad34fc6b3686040518080602001828103825260118152602001807f416e7377657220636f6c6c65637465642100000000000000000000000000000081525060200191505060405180910390a1601b6000888152602001908152602001600020600001600001601b600089815260200190815260200160002060000160010160009054906101000a900460ff16601b60008a815260200190815260200160002060000160020154601b60008b8152602001908152602001600020600301600001601b60008c815260200190815260200160002060030160010160009054906101000a900460ff16601b60008d815260200190815260200160002060030160020154858054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611c925780601f10611c6757610100808354040283529160200191611c92565b820191906000526020600020905b815481529060010190602001808311611c7557829003601f168201915b50505050509550828054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611d2e5780601f10611d0357610100808354040283529160200191611d2e565b820191906000526020600020905b815481529060010190602001808311611d1157829003601f168201915b5050505050925095509550955095509550955091939550919395565b6060816040516020018082600019166000191681526020019150506040516020818303038152906040529050919050565b60606000611d8761548e565b611d8f61548e565b611d9761548e565b611d9f61548e565b601b60008d81526020019081526020016000206003016000018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611e4c5780601f10611e2157610100808354040283529160200191611e4c565b820191906000526020600020905b815481529060010190602001808311611e2f57829003601f168201915b505050505084600001819052506000846020019015159081151581525050601b60008d815260200190815260200160002060030160020154846040018181525050611fb08b600360066040518084805190602001908083835b602083101515611eca5780518252602082019150602081019050602083039250611ea5565b6001836020036101000a03801982511681845116808217855250505050505090500183805460018160011615610100020316600290048015611f435780601f10611f21576101008083540402835291820191611f43565b820191906000526020600020905b815481529060010190602001808311611f2f575b505082805460018160011615610100020316600290048015611f9c5780601f10611f7a576101008083540402835291820191611f9c565b820191906000526020600020905b815481529060010190602001808311611f88575b505093505050506040518091039020611d4a565b83600001819052506000836020019015159081151581525050868360400181815250508a82600001819052506000826020019015159081151581525050898260400181815250506121c86120e384601560606040519081016040529081600082018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156120a55780601f1061207a576101008083540402835291602001916120a5565b820191906000526020600020905b81548152906001019060200180831161208857829003601f168201915b505050505081526020016001820160009054906101000a900460ff16151515158152602001600282015481525050876144bf9092919063ffffffff16565b601560606040519081016040529081600082018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561218a5780601f1061215f5761010080835404028352916020019161218a565b820191906000526020600020905b81548152906001019060200180831161216d57829003601f168201915b505050505081526020016001820160009054906101000a900460ff161515151581526020016002820154815250508461458a9092919063ffffffff16565b9050806000015181604001518191509550955050505050965096945050505050565b60025481565b6000600160028111156121ff57fe5b6000809054906101000a900460ff16600281111561221957fe5b14806122285750600254600154105b1561243b57601b6000600154815260200190815260200160002090508481600001600001908051906020019061225f9291906154b2565b5060008160000160010160006101000a81548160ff021916908315150217905550838160000160020181905550828160030160000190805190602001906122a79291906154b2565b5060008160030160010160006101000a81548160ff0219169083151502179055508181600301600201819055506001601c60015490806001815401808255809150509060018203906000526020600020016000909192909190915055505060018054016001819055507ff3fce91ac1ec8c74b8e7f5a9c371d97dec43ff523517eaee885d9b87efc8bce76040518080602001828103825260118152602001807f416e73776572207375626d69747465642100000000000000000000000000000081525060200191505060405180910390a160025460015414156124365760026000806101000a81548160ff021916908360028111156123a257fe5b02179055507ff3fce91ac1ec8c74b8e7f5a9c371d97dec43ff523517eaee885d9b87efc8bce760405180806020018281038252602d8152602001807f4c61737420416e73776572207375626d69747465642120436f6c6c656374696f81526020017f6e205068617365204f766572210000000000000000000000000000000000000081525060400191505060405180910390a15b6124f0565b7ff3fce91ac1ec8c74b8e7f5a9c371d97dec43ff523517eaee885d9b87efc8bce76040518080602001828103825260468152602001807f436f6c6c656374696f6e205068617365204f7665722120416e7377657273206381526020017f616e6e6f74206265207375626d697474656420696e20436f6c6c65637465642081526020017f506861736521000000000000000000000000000000000000000000000000000081525060600191505060405180910390a15b5050505050565b600061250161548e565b61250961548e565b61251161548e565b6125208c8c8b8b8b8b8b610fec565b819150846000018560400182815250829052505060008360200190151590811515815250506125538c8c8c8c8c8a611d7b565b8191508360000184604001828152508290525050600082602001901515908115158152505086816000018190525060008160200190151590811515815250508581604001818152505060006125aa848460016145ae565b1480156126975750600061269482600f60606040519081016040529081600082018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561265f5780601f106126345761010080835404028352916020019161265f565b820191906000526020600020905b81548152906001019060200180831161264257829003601f168201915b505050505081526020016001820160009054906101000a900460ff1615151515815260200160028201548152505060016145ae565b14155b80156127835750600061278082601860606040519081016040529081600082018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561274b5780601f106127205761010080835404028352916020019161274b565b820191906000526020600020905b81548152906001019060200180831161272e57829003601f168201915b505050505081526020016001820160009054906101000a900460ff1615151515815260200160028201548152505060016145ae565b14155b156127f9577f26243cd5e1909b9a6043e9e08fb43ae6e775c8ebe19a36e45ca3ad050aa29c6560405180806020018281038252601a8152602001807f506c61696e74657874206973206f7574206f662072616e67652100000000000081525060200191505060405180910390a160019350612866565b7f26243cd5e1909b9a6043e9e08fb43ae6e775c8ebe19a36e45ca3ad050aa29c6560405180806020018281038252601a8152602001807f506c61696e746578742069732077697468696e2072616e67652100000000000081525060200191505060405180910390a1600093505b50505098975050505050505050565b600061287f61548e565b61288761548e565b61288f61548e565b61289761548e565b8984600001819052506000846020019015159081151581525050888460400181815250506128ca8c8c8c8c8c8c8c613e70565b819150846000018560400182815250829052505060008360200190151590811515815250506128fe8c8c8c8c8c8c8c612b5b565b81915083600001846040018281525082905250506000816020019015159081151581525050612a0c82601560606040519081016040529081600082018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156129ce5780601f106129a3576101008083540402835291602001916129ce565b820191906000526020600020905b8154815290600101906020018083116129b157829003601f168201915b505050505081526020016001820160009054906101000a900460ff161515151581526020016002820154815250508661458a9092919063ffffffff16565b90506000612a1c848360016145ae565b1415612ab9577f9631710f779dcd50c182f8d19f5eadddeb8c00bbe392df5e8335286d98056f546040518080602001828103825260338152602001807f53616d6520506c61696e746578742050726f6f6620416363657074656421205081526020017f6c61696e7465787473206172652073616d65210000000000000000000000000081525060400191505060405180910390a160019450612b4c565b7f9631710f779dcd50c182f8d19f5eadddeb8c00bbe392df5e8335286d98056f546040518080602001828103825260388152602001807f53616d6520506c61696e746578742050726f6f662052656a656374656421205081526020017f6c61696e74657874732061726520646966666572656e7421000000000000000081525060400191505060405180910390a1600094505b50505050979650505050505050565b60606000612b6761548e565b612b6f61548e565b612b7761548e565b612b7f61548e565b612b8761548e565b601b60008f81526020019081526020016000206003016000018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612c345780601f10612c0957610100808354040283529160200191612c34565b820191906000526020600020905b815481529060010190602001808311612c1757829003601f168201915b505050505085600001819052506000856020019015159081151581525050601b60008f815260200190815260200160002060030160020154856040018181525050601b60008e81526020019081526020016000206000016000018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612d225780601f10612cf757610100808354040283529160200191612d22565b820191906000526020600020905b815481529060010190602001808311612d0557829003601f168201915b505050505084600001819052506000846020019015159081151581525050601b60008e815260200190815260200160002060000160020154846040018181525050612e868c600360066040518084805190602001908083835b602083101515612da05780518252602082019150602081019050602083039250612d7b565b6001836020036101000a03801982511681845116808217855250505050505090500183805460018160011615610100020316600290048015612e195780601f10612df7576101008083540402835291820191612e19565b820191906000526020600020905b815481529060010190602001808311612e05575b505082805460018160011615610100020316600290048015612e725780601f10612e50576101008083540402835291820191612e72565b820191906000526020600020905b815481529060010190602001808311612e5e575b505093505050506040518091039020611d4a565b8260000181905250600082602001901515908115158152505087826040018181525050898360000181905250600083602001901515908115158152505088836040018181525050613186612fb984601560606040519081016040529081600082018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612f7b5780601f10612f5057610100808354040283529160200191612f7b565b820191906000526020600020905b815481529060010190602001808311612f5e57829003601f168201915b505050505081526020016001820160009054906101000a900460ff16151515158152602001600282015481525050876144bf9092919063ffffffff16565b601560606040519081016040529081600082018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156130605780601f1061303557610100808354040283529160200191613060565b820191906000526020600020905b81548152906001019060200180831161304357829003601f168201915b505050505081526020016001820160009054906101000a900460ff1615151515815260200160028201548152505061317785601560606040519081016040529081600082018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156131395780601f1061310e57610100808354040283529160200191613139565b820191906000526020600020905b81548152906001019060200180831161311c57829003601f168201915b505050505081526020016001820160009054906101000a900460ff161515151581526020016002820154815250508a6144bf9092919063ffffffff16565b61458a9092919063ffffffff16565b90508060000151816040015181915096509650505050505097509795505050505050565b606060006131b661548e565b6131be61548e565b6131c661548e565b6131ce61548e565b6131d661548e565b6132f98b600360066040518084805190602001908083835b60208310151561321357805182526020820191506020810190506020830392506131ee565b6001836020036101000a0380198251168184511680821785525050505050509050018380546001816001161561010002031660029004801561328c5780601f1061326a57610100808354040283529182019161328c565b820191906000526020600020905b815481529060010190602001808311613278575b5050828054600181600116156101000203166002900480156132e55780601f106132c35761010080835404028352918201916132e5565b820191906000526020600020905b8154815290600101906020018083116132d1575b505093505050506040518091039020611d4a565b8560000181905250600085602001901515908115158152505087856040018181525050898460000181905250600084602001901515908115158152505088846040018181525050601b60008e81526020019081526020016000206000016000018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156133ed5780601f106133c2576101008083540402835291602001916133ed565b820191906000526020600020905b8154815290600101906020018083116133d057829003601f168201915b505050505083600001819052506000836020019015159081151581525050601b60008e815260200190815260200160002060000160020154836040018181525050601b60008d81526020019081526020016000206000016000018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156134db5780601f106134b0576101008083540402835291602001916134db565b820191906000526020600020905b8154815290600101906020018083116134be57829003601f168201915b505050505082600001819052506000826020019015159081151581525050601b60008d8152602001908152602001600020600001600201548260400181815250506139916136f085601560606040519081016040529081600082018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156135ca5780601f1061359f576101008083540402835291602001916135ca565b820191906000526020600020905b8154815290600101906020018083116135ad57829003601f168201915b505050505081526020016001820160009054906101000a900460ff161515151581526020016002820154815250506136e186601560606040519081016040529081600082018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156136a35780601f10613678576101008083540402835291602001916136a3565b820191906000526020600020905b81548152906001019060200180831161368657829003601f168201915b505050505081526020016001820160009054906101000a900460ff161515151581526020016002820154815250508961458a9092919063ffffffff16565b6144bf9092919063ffffffff16565b601560606040519081016040529081600082018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156137975780601f1061376c57610100808354040283529160200191613797565b820191906000526020600020905b81548152906001019060200180831161377a57829003601f168201915b505050505081526020016001820160009054906101000a900460ff1615151515815260200160028201548152505061398288601560606040519081016040529081600082018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156138705780601f1061384557610100808354040283529160200191613870565b820191906000526020600020905b81548152906001019060200180831161385357829003601f168201915b505050505081526020016001820160009054906101000a900460ff16151515158152602001600282015481525050600f60606040519081016040529081600082018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156139455780601f1061391a57610100808354040283529160200191613945565b820191906000526020600020905b81548152906001019060200180831161392857829003601f168201915b505050505081526020016001820160009054906101000a900460ff161515151581526020016002820154815250506144bf9092919063ffffffff16565b61458a9092919063ffffffff16565b905080600001518160400151819150965096505050505050965096945050505050565b6000600154905090565b601b6020528060005260406000206000915090508060000160606040519081016040529081600082018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015613a7b5780601f10613a5057610100808354040283529160200191613a7b565b820191906000526020600020905b815481529060010190602001808311613a5e57829003601f168201915b505050505081526020016001820160009054906101000a900460ff16151515158152602001600282015481525050908060030160606040519081016040529081600082018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015613b535780601f10613b2857610100808354040283529160200191613b53565b820191906000526020600020905b815481529060010190602001808311613b3657829003601f168201915b505050505081526020016001820160009054906101000a900460ff16151515158152602001600282015481525050905082565b60015481565b6000613b9661548e565b613b9e61548e565b613ba661548e565b613bae61548e565b613bbc8c8c8c8b8b8b6131aa565b81915085600001866040018281525082905250506000846020019015159081151581525050613bef8c8c8c8b8b8b611571565b81915084600001856040018281525082905250506000836020019015159081151581525050898260000181905250600082602001901515908115158152505088826040018181525050613d2183601560606040519081016040529081600082018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015613ce35780601f10613cb857610100808354040283529160200191613ce3565b820191906000526020600020905b815481529060010190602001808311613cc657829003601f168201915b505050505081526020016001820160009054906101000a900460ff161515151581526020016002820154815250508461458a9092919063ffffffff16565b90506000613d31858360016145ae565b1415613dce577f60839697e2e29297e6ea55c82926c9020e5ff4669ff08eb1853be13ca082abc96040518080602001828103825260348152602001807f3020616e6420312050726f6f662041636365707465642120506c61696e74657881526020017f747320617265205a65726f20616e64204f6e652100000000000000000000000081525060400191505060405180910390a160019450613e61565b7f60839697e2e29297e6ea55c82926c9020e5ff4669ff08eb1853be13ca082abc96040518080602001828103825260388152602001807f3020616e6420312050726f6f662052656a65637465642120506c61696e74657881526020017f747320617265204e6f74205a65726f20616e64204f6e6521000000000000000081525060400191505060405180910390a1600094505b50505050979650505050505050565b60606000613e7c61548e565b613e8461548e565b613e8c61548e565b613e9461548e565b613e9c61548e565b613fbf8c600360066040518084805190602001908083835b602083101515613ed95780518252602082019150602081019050602083039250613eb4565b6001836020036101000a03801982511681845116808217855250505050505090500183805460018160011615610100020316600290048015613f525780601f10613f30576101008083540402835291820191613f52565b820191906000526020600020905b815481529060010190602001808311613f3e575b505082805460018160011615610100020316600290048015613fab5780601f10613f89576101008083540402835291820191613fab565b820191906000526020600020905b815481529060010190602001808311613f97575b505093505050506040518091039020611d4a565b8260000181905250600082602001901515908115158152505087826040018181525050601b60008f81526020019081526020016000206000016000018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561408f5780601f106140645761010080835404028352916020019161408f565b820191906000526020600020905b81548152906001019060200180831161407257829003601f168201915b505050505085600001819052506000856020019015159081151581525050601b60008f815260200190815260200160002060000160020154856040018181525050601b60008e81526020019081526020016000206003016000018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561417d5780601f106141525761010080835404028352916020019161417d565b820191906000526020600020905b81548152906001019060200180831161416057829003601f168201915b505050505084600001819052506000846020019015159081151581525050601b60008e81526020019081526020016000206003016002015484604001818152505089836000018190525060008360200190151590811515815250508883604001818152505061449b6142ce84601560606040519081016040529081600082018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156142905780601f1061426557610100808354040283529160200191614290565b820191906000526020600020905b81548152906001019060200180831161427357829003601f168201915b505050505081526020016001820160009054906101000a900460ff16151515158152602001600282015481525050886144bf9092919063ffffffff16565b601560606040519081016040529081600082018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156143755780601f1061434a57610100808354040283529160200191614375565b820191906000526020600020905b81548152906001019060200180831161435857829003601f168201915b505050505081526020016001820160009054906101000a900460ff1615151515815260200160028201548152505061448c85601560606040519081016040529081600082018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561444e5780601f106144235761010080835404028352916020019161444e565b820191906000526020600020905b81548152906001019060200180831161443157829003601f168201915b505050505081526020016001820160009054906101000a900460ff16151515158152602001600282015481525050896144bf9092919063ffffffff16565b61458a9092919063ffffffff16565b90508060000151816040015181915096509650505050505097509795505050505050565b6144c761548e565b60606000801515856020015115151415156144e157600080fd5b6144f8866000015186600001518660000151614767565b91506020820151905061010060016020845181151561451357fe5b04030261451f82614839565b019050818360000181905250600015158660200151151514806145575750856020015180156145565750600061455486614a8a565b145b5b614562576001614565565b60005b8360200190151590811515815250508083604001818152505082925050509392505050565b61459261548e565b6145a561459f8585614a9f565b83614b01565b90509392505050565b600080600080600080600080600196508815614680578a6020015180156145d6575089602001515b15614603577fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff965061467f565b600015158b6020015115151480156146235750600115158a602001511515145b156146315760019750614759565b600115158b6020015115151480156146515750600015158a602001511515145b1561467e577fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff9750614759565b5b5b89604001518b60400151111561469b57866001029750614759565b8a604001518a6040015111156146d557867fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff029750614759565b8a6000015151915060208b5101955060208a51019450600090505b81811015614754578086015193508085015192508284111561471757866001029750614759565b8383111561474957867fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff029750614759565b6020810190506146f0565b600097505b505050505050509392505050565b606083518351835160405183815282602082015281604082015283606082018560208b0160046101c2fa84606001848184018660208c0160046101c2fa91508481019050838184018560208b0160046101c2fa915081600081146147ca576147cc565bfe5b5083810190508383606001828560056105465a03fa915081600081146147f1576147f3565bfe5b5083836060015b600160008251141415614818576020810190506020820391506147fa565b60208103985081895285856060010160405250505050505050509392505050565b60008082905060018303925060028304831792506004830483179250601083048317925061010083048317925062010000830483179250640100000000830483179250680100000000000000008304831792507001000000000000000000000000000000008304831792506001830192506040517ff8f9cbfae6cc78fbefe7cdc3a1793dfcf4f0e8bbd8cec470b6a28a7a5a3e1efd81527ff5ecf1b3e9debc68e1d9cfabc5997135bfb7a7a3938b7b606b5b4b3f2f1f0ffe60208201527ff6e4ed9ff2d6b458eadcdf97bd91692de2d4da8fd2d0ac50c6ae9a827252361660408201527fc8c0b887b0a8a4489c948c7f847c6125746c645c544c444038302820181008ff60608201527ff7cae577eec2a03cf3bad76fb589591debb2dd67e0aa9834bea6925f6a4a2e0e60808201527fe39ed557db96902cd38ed14fad815115c786af479b7e8324736353433727170760a08201527fc976c13bb96e881cb166a933a55e490d9d56952b8d4e801485467d236242260660c08201527f753a6d1b65325d0c552a4d1345224105391a310b29122104190a11030902010060e082015261010081016040527e818283848586878898a8b8c8d8e8f929395969799a9b9d9e9faaeb6bedeeff7f01000000000000000000000000000000000000000000000000000000000000008082870204818160ff038501510495507f800000000000000000000000000000000000000000000000000000000000000085116101000286019550505050506000600182038216148015614a78575060008314155b15614a84578160010191505b50919050565b60008151518251016002815106915050919050565b614aa761548e565b614aaf61548e565b614abb84846000614b5d565b91506000614acb858560016145ae565b141515614aed57614ade84846001614b5d565b9050614aea8282614c74565b91505b614af8826002614eca565b91505092915050565b614b0961548e565b614b1161548e565b6060604051908101604052806040805190810160405280602081526020016001815250815260200160001515815260200160018152509050614b548482856144bf565b91505092915050565b614b6561548e565b614b6d61548e565b60008060606000614b7c61548e565b60606040519081016040528060408051908101604052806020815260200160028152508152602001600015158152602001600281525095506000945060008814614bcf57614bca8a8a614c74565b614bda565b614bd98a8a614faa565b5b96508660400151915060028202945061010085811515614bf657fe5b0660019060020a029350604080519081016040528060208152602001600081525092506020600161010087040102835283602084015260208351018301604052828160000181905250600081602001901515908115158152505084816040018181525050614c658787836144bf565b96505050505050509392505050565b614c7c61548e565b614c8461548e565b60606000806060604051908101604052806040805190810160405280602081526020016000815250815260200160001515815260200160008152509350614ccd878760006145ae565b9150866020015180614ce0575085602001515b15614e115786602001518015614cf7575085602001515b15614d9b576001821415614d3557614d178760000151876000015161520a565b80925081945050506001856020019015159081151581525050614d96565b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff821415614d8d57614d6f8660000151886000015161520a565b80925081945050506000856020019015159081151581525050614d95565b839450614ec0565b5b614e0c565b600082121515614dc957614dbc87600001518760000151896040015161531b565b8092508194505050614de9565b614de086600001518860000151886040015161531b565b80925081945050505b8660200151614df9576000614dfc565b60015b8560200190151590811515815250505b614eac565b6001821415614e4a57614e2c8760000151876000015161520a565b80925081945050506000856020019015159081151581525050614eab565b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff821415614ea257614e848660000151886000015161520a565b80925081945050506001856020019015159081151581525050614eaa565b839450614ec0565b5b5b828560000181905250808560400181815250505b5050505092915050565b614ed261548e565b60606000806000806000806000896101000395508a6000015151915060206000039250818b510193506020820390505b82811015614f5557835196506000811460018114614f265760208503519550614f2b565b600095505b5089879060020a9004965085859060020a0294508487178452602084039350602081039050614f02565b6020840193505b600084511415614f7757602084019350602082039150614f5c565b602084039750818852878b60000181905250898b60400151038b60400181815250508a9850505050505050505092915050565b614fb261548e565b614fba61548e565b606060008060606040519081016040528060408051908101604052806020815260200160008152508152602001600015158152602001600081525093506000876040015114801561500f575060008660400151145b1561501c57839450615200565b60008760400151141561503157859450615200565b60008660400151141561504657869450615200565b615052878760006145ae565b9050866020015180615065575085602001515b1561518c578660200151801561507c575085602001515b156150e5576000811215156150af576150a287600001518760000151896040015161531b565b80935081945050506150cf565b6150c686600001518860000151886040015161531b565b80935081945050505b6001856020019015159081151581525050615187565b6001811415615121576151008760000151876000015161520a565b80935081945050508660200151856020019015159081151581525050615186565b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff81141561517d5761515b8660000151886000015161520a565b8093508194505050866020015115856020019015159081151581525050615185565b839450615200565b5b5b6151ec565b6000811215156151ba576151ad87600001518760000151896040015161531b565b80935081945050506151da565b6151d186600001518860000151886040015161531b565b80935081945050505b60008560200190151590811515815250505b828560000181905250818560400181815250505b5050505092915050565b6060600060606000806000915059600160000388518851808203828c01828c0184870160208101865b600080821414156152c457845186821160018114615275578d8203855260018e1460008314166001811461526a5760009e5061526f565b60019e505b506152ab565b85518e81840303865260018f148c8214168f82018410176001811461529d5760009f506152a2565b60019f505b50602087039650505b5060208403935060208603955050602081039050615233565b506020820191505b6000825114156152ed576020890198506020870396506020820191506152cc565b889b50868c52806040525050505050505050506153098361546a565b90508281945094505050509250929050565b6060600060606000596001600003600089518a0189518a018b5160208601018c515b600080821414156153ea5783518d518f5103821160018114615382578682018452600187148289141660018114615377576000975061537c565b600197505b506153d1565b84518781840101855287810389038311600181146153c3576000821160008a11178a851416600181146153b857600099506153bd565b600199505b506153c8565b600198505b50602086039550505b506020830392506020850394505060208103905061533d565b5060008414600181146154005760018252615407565b6020870196505b50859750836020028d51018852602088510188016040525050505050506020820151905060016101008681151561543a57fe5b06829060020a9004148061544e5750600181145b1561545a578460010194505b8185935093505050935093915050565b60008060208301519050600860208451030261548582614839565b01915050919050565b60606040519081016040528060608152602001600015158152602001600081525090565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106154f357805160ff1916838001178555615521565b82800160010185558215615521579182015b82811115615520578251825591602001919060010190615505565b5b50905061552e9190615532565b5090565b61555491905b80821115615550576000816000905550600101615538565b5090565b905600a165627a7a72305820ae2363fd5ff26923c7badcf7a8499dcdfb90344f43abe5000c6408c91542d09f0029'

    addr = Web3.toChecksumAddress('0x08D9c4E8CCDFdb3D173ffb04960499bdAeafF71f')


    web3, pwd = connect()
    contract = web3.eth.contract(abi=abi, bytecode=bin, address=addr)

    for j in range(0, num_workers):
        c_1, c_2 = enc(answers[j], rand[j])
        while((modinv(pow(c_1,k,p),p)==0) or (modinv(c_1, p)==0)):
            rand_bytes = get_random_bytes(32)
            c_1, c_2 = enc(answers[j], rand_bytes)
        submit_answers = contract.functions.submit_answers(int_to_bytes(c_1), count_bitlen(c_1), int_to_bytes(c_2), count_bitlen(c_2))
        #web3.personal.unlockAccount(web3.personal.listAccounts[2], pwd)
        gas = submit_answers.estimateGas()
        web3.personal.unlockAccount(web3.personal.listAccounts[2], pwd)
        tx_hash = submit_answers.transact({'gas': gas, 'gasPrice': 5000000000})
        print(web3.toHex(tx_hash))
        tx_receipt = web3.eth.waitForTransactionReceipt(tx_hash, 600)
        print(tx_receipt)